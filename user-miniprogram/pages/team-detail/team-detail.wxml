<view class="container">
  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <block wx:else>
    <!-- è¿åŠ¨ç±»å‹æ ‡ç­¾ -->
    <view class="sport-header {{team.sport_type}}">
      <view class="sport-name">{{team.sport_type_name}}</view>
      <view class="team-status-badge {{team.status}}">
        <text wx:if="{{team.status === 'recruiting'}}">æ‹›å‹Ÿä¸­</text>
        <text wx:elif="{{team.status === 'full'}}">å·²æ»¡å‘˜</text>
        <text wx:elif="{{team.status === 'completed'}}">å·²å®Œæˆ</text>
        <text wx:else>å·²å–æ¶ˆ</text>
      </view>
    </view>

    <!-- ç»„é˜Ÿä¿¡æ¯ -->
    <view class="info-card">
      <view class="team-title">{{team.title}}</view>

      <view class="info-list">
        <view class="info-item">
          <text class="info-icon">ğŸ“…</text>
          <text class="info-label">æ´»åŠ¨æ—¶é—´</text>
          <text class="info-value">{{team.activity_date}} {{team.activity_time}}</text>
        </view>
        <view class="info-item" wx:if="{{team.location}}">
          <text class="info-icon">ğŸ“</text>
          <text class="info-label">æ´»åŠ¨åœ°ç‚¹</text>
          <text class="info-value">{{team.location}}</text>
        </view>
        <view class="info-item">
          <text class="info-icon">ğŸ‘¥</text>
          <text class="info-label">äººæ•°</text>
          <text class="info-value highlight">{{team.current_members}}/{{team.max_members}}äºº</text>
        </view>
        <view class="info-item">
          <text class="info-icon">ğŸ’°</text>
          <text class="info-label">è´¹ç”¨è¯´æ˜</text>
          <text class="info-value" wx:if="{{team.fee_type === 'free'}}">å…è´¹å‚ä¸</text>
          <text class="info-value" wx:elif="{{team.fee_type === 'AA'}}">AAå‡æ‘Š</text>
          <text class="info-value" wx:else>{{team.fee_amount}}é‡‘å¸/äºº</text>
        </view>
      </view>
    </view>

    <!-- ç»„é˜Ÿæè¿° -->
    <view class="desc-card" wx:if="{{team.description}}">
      <view class="card-title">ç»„é˜Ÿè¯´æ˜</view>
      <view class="desc-content">{{team.description}}</view>
    </view>

    <!-- å‘èµ·äººä¿¡æ¯ -->
    <view class="creator-card">
      <view class="card-title">å‘èµ·äºº</view>
      <view class="creator-info">
        <image class="creator-avatar" src="{{team.creator.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
        <view class="creator-detail">
          <text class="creator-name">{{team.creator.nickname || 'åŒ¿åç”¨æˆ·'}}</text>
          <text class="creator-tag" wx:if="{{isCreator}}">æˆ‘å‘èµ·çš„</text>
        </view>
        <view class="contact-btn" bindtap="contactCreator" wx:if="{{!isCreator && team.creator.phone}}">
          <text>è”ç³»TA</text>
        </view>
      </view>
    </view>

    <!-- æˆå‘˜åˆ—è¡¨ -->
    <view class="members-card" wx:if="{{team.members && team.members.length > 0}}">
      <view class="card-title">å·²åŠ å…¥æˆå‘˜ï¼ˆ{{team.current_members}}äººï¼‰</view>
      <view class="members-list">
        <view class="member-item" wx:for="{{team.members}}" wx:key="id" wx:if="{{item.status === 'joined'}}">
          <image class="member-avatar" src="{{item.member.avatar || '/images/default-avatar.png'}}" mode="aspectFill"></image>
          <text class="member-name">{{item.member.nickname || 'åŒ¿å'}}</text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨æ“ä½œæ  -->
    <view class="bottom-bar">
      <button class="btn-share" open-type="share">
        <text>é‚€è¯·å¥½å‹</text>
      </button>

      <!-- æ ¹æ®çŠ¶æ€æ˜¾ç¤ºä¸åŒæŒ‰é’® -->
      <block wx:if="{{team.status === 'recruiting'}}">
        <button class="btn-quit" wx:if="{{hasJoined && !isCreator}}" bindtap="quitTeam" loading="{{submitting}}" disabled="{{submitting}}">
          é€€å‡ºé˜Ÿä¼
        </button>
        <button class="btn-join" wx:elif="{{!hasJoined && !isCreator}}" bindtap="joinTeam" loading="{{submitting}}" disabled="{{submitting}}">
          ç«‹å³åŠ å…¥
        </button>
        <button class="btn-disabled" wx:elif="{{isCreator}}" disabled>
          æˆ‘æ˜¯é˜Ÿé•¿
        </button>
      </block>
      <block wx:else>
        <button class="btn-disabled" disabled>
          <text wx:if="{{team.status === 'full'}}">å·²æ»¡å‘˜</text>
          <text wx:elif="{{team.status === 'completed'}}">å·²ç»“æŸ</text>
          <text wx:else>å·²å–æ¶ˆ</text>
        </button>
      </block>
    </view>
  </block>
</view>
