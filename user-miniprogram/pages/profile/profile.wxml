<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯ -->
  <view class="user-header" wx:if="{{isLoggedIn && memberInfo}}">
    <image class="user-avatar" src="{{memberInfo.avatar || '/assets/images/avatar-default.png'}}" mode="aspectFill"></image>
    <view class="user-info">
      <view class="user-name-row">
        <text class="user-name">{{memberInfo.nickname || 'ç”¨æˆ·'}}</text>
        <view class="user-level {{memberInfo.level_type || 'normal'}}" wx:if="{{memberInfo.level_name}}">
          <image class="level-icon" wx:if="{{memberInfo.level_icon}}" src="{{memberInfo.level_icon}}" mode="aspectFit"></image>
          <text class="level-tag">{{memberInfo.level_name}}</text>
        </view>
      </view>
      <text class="user-id">ID: {{memberInfo.id}}</text>
    </view>
  </view>

  <!-- æœªç™»å½•çŠ¶æ€ -->
  <view class="user-header guest" wx:else bindtap="goToLogin">
    <image class="user-avatar" src="/assets/images/avatar-default.png" mode="aspectFill"></image>
    <view class="user-info">
      <text class="login-text">ç‚¹å‡»ç™»å½•</text>
      <text class="login-hint">ç™»å½•åäº«å—æ›´å¤šæœåŠ¡</text>
    </view>
  </view>

  <!-- èµ„äº§ä¿¡æ¯ -->
  <view class="asset-card" wx:if="{{isLoggedIn}}">
    <view class="asset-item" bindtap="goToWallet">
      <text class="asset-value">{{memberInfo.coin_balance || 0}}</text>
      <text class="asset-label">é‡‘å¸</text>
    </view>
    <view class="asset-divider"></view>
    <view class="asset-item" bindtap="goToWallet">
      <text class="asset-value">{{memberInfo.point_balance || 0}}</text>
      <text class="asset-label">ç§¯åˆ†</text>
    </view>
    <view class="asset-divider"></view>
    <view class="asset-item" bindtap="goToRecharge">
      <text class="asset-value recharge-btn">å……å€¼</text>
      <text class="asset-label">é‡‘å¸å……å€¼</text>
    </view>
  </view>

  <!-- æ•™ç»ƒå…¥å£ -->
  <view class="coach-entry-card" wx:if="{{isLoggedIn}}" bindtap="goToCoachCenter">
    <view class="coach-entry-left">
      <image class="coach-entry-icon" src="/assets/icons/coach-entry.png" mode="aspectFit"></image>
      <view class="coach-entry-info">
        <text class="coach-entry-title">æ•™ç»ƒä¸­å¿ƒ</text>
        <text class="coach-entry-desc">{{isCoach ? 'ç®¡ç†æ‚¨çš„è¯¾ç¨‹å’Œé¢„çº¦' : 'ç”³è¯·æˆä¸ºæ•™ç»ƒ'}}</text>
      </view>
    </view>
    <text class="coach-entry-arrow">></text>
  </view>

  <!-- è®­ç»ƒæ—¥å†å…¥å£ -->
  <view class="training-card" wx:if="{{isLoggedIn}}" bindtap="goToCalendar">
    <view class="training-header">
      <text class="training-title">è®­ç»ƒæ—¥å†</text>
      <text class="training-more">æŸ¥çœ‹æ›´å¤š ></text>
    </view>
    <view class="training-stats">
      <view class="stat-item">
        <text class="stat-value">{{checkinStats.month_count || 0}}</text>
        <text class="stat-label">æœ¬æœˆæ‰“å¡</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{checkinStats.month_duration || 0}}</text>
        <text class="stat-label">æ€»æ—¶é•¿(åˆ†)</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{checkinStats.month_points || 0}}</text>
        <text class="stat-label">è·å¾—ç§¯åˆ†</text>
      </view>
    </view>
  </view>

  <!-- æ’è¡Œæ¦œå…¥å£ -->
  <view class="rank-card" wx:if="{{isLoggedIn}}" bindtap="goToLeaderboard">
    <view class="rank-left">
      <view class="rank-icon-emoji">ğŸ†</view>
      <view class="rank-info">
        <text class="rank-title">è¿åŠ¨æ’è¡Œæ¦œ</text>
        <text class="rank-desc">çœ‹çœ‹ä½ çš„è¿åŠ¨æ’å</text>
      </view>
    </view>
    <text class="rank-arrow">></text>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-card">
    <view
      class="menu-item"
      wx:for="{{menus}}"
      wx:key="text"
      bindtap="onMenuTap"
      data-url="{{item.url}}"
    >
      <image class="menu-icon" src="{{item.icon}}" mode="aspectFit"></image>
      <text class="menu-text">{{item.text}}</text>
      <text class="menu-arrow">></text>
    </view>
  </view>

  <!-- å·¥å…·èœå• -->
  <view class="menu-card">
    <view
      class="menu-item"
      wx:for="{{tools}}"
      wx:key="text"
      bindtap="onToolTap"
      data-action="{{item.action}}"
      data-url="{{item.url}}"
    >
      <image class="menu-icon" src="{{item.icon}}" mode="aspectFit"></image>
      <text class="menu-text">{{item.text}}</text>
      <text class="menu-arrow">></text>
    </view>
  </view>
</view>
