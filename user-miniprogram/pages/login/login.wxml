<view class="container">
  <!-- 登录界面 -->
  <view wx:if="{{!needCompleteProfile}}">
    <view class="logo-section">
      <image class="logo" src="/assets/logo.png" mode="aspectFit"></image>
      <text class="title">运动社交</text>
      <text class="subtitle">专业的体育场馆服务平台</text>
    </view>

    <view class="login-section">
      <!-- 微信一键登录 -->
      <button
        class="btn btn-primary"
        bindtap="wxLogin"
        loading="{{isLoading}}"
        disabled="{{isLoading}}"
      >
        微信一键登录
      </button>

      <!-- 手机号快捷登录（需要用户授权） -->
      <button
        class="btn btn-phone"
        open-type="getPhoneNumber"
        bindgetphonenumber="getPhoneNumber"
        loading="{{isLoading}}"
        disabled="{{isLoading}}"
      >
        手机号快捷登录
      </button>

      <view class="divider">
        <view class="line"></view>
        <text class="text">或</text>
        <view class="line"></view>
      </view>

      <!-- 手机号输入登录（开发测试用） -->
      <view class="input-group">
        <input
          class="input"
          type="number"
          placeholder="请输入手机号"
          maxlength="11"
          value="{{phone}}"
          bindinput="onPhoneInput"
        />
      </view>

      <button
        class="btn btn-outline"
        bindtap="loginByPhone"
        loading="{{isLoading}}"
        disabled="{{isLoading}}"
      >
        手机号登录
      </button>
    </view>

    <view class="footer">
      <text class="tip">登录即表示同意</text>
      <text class="link">《用户协议》</text>
      <text class="tip">和</text>
      <text class="link">《隐私政策》</text>
    </view>
  </view>

  <!-- 完善资料（登录后，昵称为默认值时显示） -->
  <view class="profile-section" wx:if="{{needCompleteProfile}}">
    <view class="profile-title">完善个人资料</view>
    <view class="profile-subtitle">设置头像和昵称，让大家认识你</view>

    <view class="avatar-picker">
      <button class="avatar-btn" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image class="avatar-img" src="{{tempAvatar || '/assets/images/avatar-default.png'}}" mode="aspectFill"></image>
        <view class="avatar-edit-hint">点击选择头像</view>
      </button>
    </view>

    <view class="nickname-input-group">
      <text class="nickname-label">昵称</text>
      <input
        class="nickname-input"
        type="nickname"
        placeholder="请输入昵称"
        value="{{tempNickname}}"
        bindinput="onNicknameChange"
        bindchange="onNicknameChange"
      />
    </view>

    <button
      class="btn btn-primary"
      bindtap="saveProfile"
      loading="{{isSaving}}"
      disabled="{{isSaving}}"
    >
      保存并继续
    </button>
    <view class="skip-link" bindtap="skipProfile">
      <text>跳过，稍后设置</text>
    </view>
  </view>
</view>
