<view class="container" wx:if="{{!loading}}">
  <!-- æ´»åŠ¨å›¾ç‰‡ -->
  <image class="activity-image" src="{{activity.image || '/assets/images/activity-default.jpg'}}" mode="aspectFill"></image>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="info-card">
    <view class="activity-status {{activity.statusInfo.class}}">{{activity.statusInfo.text}}</view>
    <text class="activity-title">{{activity.title}}</text>

    <view class="activity-price">
      <text class="price" wx:if="{{activity.price > 0}}">Â¥{{activity.price}}</text>
      <text class="free" wx:else>å…è´¹æŠ¥å</text>
    </view>

    <view class="info-list">
      <view class="info-item">
        <text class="info-icon">ğŸ“…</text>
        <text class="info-label">æ´»åŠ¨æ—¶é—´</text>
        <text class="info-value">{{activity.start_date}} {{activity.start_time}}</text>
      </view>
      <view class="info-item" wx:if="{{activity.location}}">
        <text class="info-icon">ğŸ“</text>
        <text class="info-label">æ´»åŠ¨åœ°ç‚¹</text>
        <text class="info-value">{{activity.location}}</text>
      </view>
      <view class="info-item">
        <text class="info-icon">ğŸ‘¥</text>
        <text class="info-label">æŠ¥åäººæ•°</text>
        <text class="info-value">{{activity.enrolled || 0}}/{{activity.max_participants || 'ä¸é™'}}</text>
      </view>
      <view class="info-item" wx:if="{{activity.organizer}}">
        <text class="info-icon">ğŸ¢</text>
        <text class="info-label">ä¸»åŠæ–¹</text>
        <text class="info-value">{{activity.organizer}}</text>
      </view>
    </view>
  </view>

  <!-- æ´»åŠ¨è¯¦æƒ… -->
  <view class="detail-card">
    <view class="card-title">æ´»åŠ¨è¯¦æƒ…</view>
    <view class="detail-content">
      <text>{{activity.description || 'æš‚æ— è¯¦æƒ…'}}</text>
    </view>
  </view>

  <!-- æŠ¥åé¡»çŸ¥ -->
  <view class="detail-card" wx:if="{{activity.notice}}">
    <view class="card-title">æŠ¥åé¡»çŸ¥</view>
    <view class="notice-content">
      <text>{{activity.notice}}</text>
    </view>
  </view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-bar">
    <view class="bar-info">
      <view class="progress-info">
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{activity.max_participants ? (activity.enrolled / activity.max_participants * 100) : 0}}%"></view>
        </view>
        <text class="progress-text">å·²æŠ¥å {{activity.enrolled || 0}} äºº</text>
      </view>
    </view>
    <button
      class="btn-enroll {{isEnrolled ? 'enrolled' : ''}}"
      bindtap="{{isEnrolled ? 'cancelEnroll' : 'enrollActivity'}}"
      loading="{{submitting}}"
      disabled="{{submitting || (!isEnrolled && !activity.statusInfo.canEnroll)}}"
    >
      {{isEnrolled ? 'å–æ¶ˆæŠ¥å' : (activity.statusInfo.canEnroll ? 'ç«‹å³æŠ¥å' : 'æ´»åŠ¨å·²ç»“æŸ')}}
    </button>
  </view>

  <!-- åº•éƒ¨å ä½ -->
  <view class="bottom-placeholder"></view>
</view>

<!-- åŠ è½½ä¸­ -->
<view class="loading-container" wx:if="{{loading}}">
  <text class="loading-text">åŠ è½½ä¸­...</text>
</view>
